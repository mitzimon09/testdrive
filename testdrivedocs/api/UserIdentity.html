<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="language" content="en" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/api.css" />
<script type="text/javascript" src="js/jquery.js"></script>
<title>UserIdentity</title>
</head>

<body>
<div id="apiPage">

<div id="apiHeader">
My Application Class Reference
</div><!-- end of header -->

<div id="content">
<h1>UserIdentity</h1>
<div id="nav">
<a href="index.html">All Packages</a>
| <a href="#properties">Properties</a>
| <a href="#methods">Methods</a>
</div>

<table class="summaryTable docClass">
<colgroup>
	<col class="col-name" />
	<col class="col-value" />
</colgroup>
<tr>
  <th>Inheritance</th>
  <td>class UserIdentity &raquo;
CUserIdentity &raquo;
CBaseUserIdentity &raquo;
CComponent</td>
</tr>
<tr>
  <th>Implements</th>
  <td>IUserIdentity</td>
</tr>
<tr>
  <th>Source Code</th>
  <td>app/components/UserIdentity.php</td>
</tr>
</table>

<div id="classDescription">
UserIdentity represents the data needed to identity a user.
It contains the authentication method that checks if the provided
data can identity the user.</div>
<a name="properties"></a>

<div class="summary docProperty">
<h2>Public Properties</h2>

<p><a href="#" class="toggle">Hide inherited properties</a></p>

<table class="summaryTable">
<colgroup>
	<col class="col-property" />
	<col class="col-type" />
	<col class="col-description" />
	<col class="col-defined" />
</colgroup>
<tr>
  <th>Property</th><th>Type</th><th>Description</th><th>Defined By</th>
</tr>
<tr class="inherited" id="errorCode">
  <td>errorCode</td>
  <td>integer</td>
  <td>the authentication error code.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="errorMessage">
  <td>errorMessage</td>
  <td>string</td>
  <td>the authentication error message.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="id">
  <td>id</td>
  <td>string</td>
  <td>Returns the unique identifier for the identity.</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="isAuthenticated">
  <td>isAuthenticated</td>
  <td>boolean</td>
  <td>Returns a value indicating whether the identity is authenticated.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="name">
  <td>name</td>
  <td>string</td>
  <td>Returns the display name for the identity.</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="password">
  <td>password</td>
  <td>string</td>
  <td>password</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="persistentStates">
  <td>persistentStates</td>
  <td>array</td>
  <td>Returns the identity states that should be persisted.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="username">
  <td>username</td>
  <td>string</td>
  <td>username</td>
  <td>CUserIdentity</td>
</tr>
</table>
</div>
<a name="methods"></a>

<div class="summary docMethod">
<h2>Public Methods</h2>

<p><a href="#" class="toggle">Hide inherited methods</a></p>

<table class="summaryTable">
<colgroup>
	<col class="col-method" />
	<col class="col-description" />
	<col class="col-defined" />
</colgroup>
<tr>
  <th>Method</th><th>Description</th><th>Defined By</th>
</tr>
<tr class="inherited" id="__call">
  <td>__call()</td>
  <td>Calls the named method which is not a class method.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="__construct">
  <td>__construct()</td>
  <td>Constructor.</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="__get">
  <td>__get()</td>
  <td>Returns a property value, an event handler list or a behavior based on its name.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="__isset">
  <td>__isset()</td>
  <td>Checks if a property value is null.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="__set">
  <td>__set()</td>
  <td>Sets value of a component property.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="__unset">
  <td>__unset()</td>
  <td>Sets a component property to be null.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="asa">
  <td>asa()</td>
  <td>Returns the named behavior object.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="attachBehavior">
  <td>attachBehavior()</td>
  <td>Attaches a behavior to this component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="attachBehaviors">
  <td>attachBehaviors()</td>
  <td>Attaches a list of behaviors to the component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="attachEventHandler">
  <td>attachEventHandler()</td>
  <td>Attaches an event handler to an event.</td>
  <td>CComponent</td>
</tr>
<tr id="authenticate">
  <td><a href="UserIdentity.html#authenticate-detail">authenticate()</a></td>
  <td>Authenticates a user.</td>
  <td>UserIdentity</td>
</tr>
<tr class="inherited" id="canGetProperty">
  <td>canGetProperty()</td>
  <td>Determines whether a property can be read.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="canSetProperty">
  <td>canSetProperty()</td>
  <td>Determines whether a property can be set.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="clearState">
  <td>clearState()</td>
  <td>Removes the specified state.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="detachBehavior">
  <td>detachBehavior()</td>
  <td>Detaches a behavior from the component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="detachBehaviors">
  <td>detachBehaviors()</td>
  <td>Detaches all behaviors from the component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="detachEventHandler">
  <td>detachEventHandler()</td>
  <td>Detaches an existing event handler.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="disableBehavior">
  <td>disableBehavior()</td>
  <td>Disables an attached behavior.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="disableBehaviors">
  <td>disableBehaviors()</td>
  <td>Disables all behaviors attached to this component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="enableBehavior">
  <td>enableBehavior()</td>
  <td>Enables an attached behavior.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="enableBehaviors">
  <td>enableBehaviors()</td>
  <td>Enables all behaviors attached to this component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="evaluateExpression">
  <td>evaluateExpression()</td>
  <td>Evaluates a PHP expression or callback under the context of this component.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="getEventHandlers">
  <td>getEventHandlers()</td>
  <td>Returns the list of attached event handlers for an event.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="getId">
  <td>getId()</td>
  <td>Returns the unique identifier for the identity.</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="getIsAuthenticated">
  <td>getIsAuthenticated()</td>
  <td>Returns a value indicating whether the identity is authenticated.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="getName">
  <td>getName()</td>
  <td>Returns the display name for the identity.</td>
  <td>CUserIdentity</td>
</tr>
<tr class="inherited" id="getPersistentStates">
  <td>getPersistentStates()</td>
  <td>Returns the identity states that should be persisted.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="getState">
  <td>getState()</td>
  <td>Gets the persisted state by the specified name.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="hasEvent">
  <td>hasEvent()</td>
  <td>Determines whether an event is defined.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="hasEventHandler">
  <td>hasEventHandler()</td>
  <td>Checks whether the named event has attached handlers.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="hasProperty">
  <td>hasProperty()</td>
  <td>Determines whether a property is defined.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="raiseEvent">
  <td>raiseEvent()</td>
  <td>Raises an event.</td>
  <td>CComponent</td>
</tr>
<tr class="inherited" id="setPersistentStates">
  <td>setPersistentStates()</td>
  <td>Sets an array of persistent states.</td>
  <td>CBaseUserIdentity</td>
</tr>
<tr class="inherited" id="setState">
  <td>setState()</td>
  <td>Sets the named state with a given value.</td>
  <td>CBaseUserIdentity</td>
</tr>
</table>
</div>
<a name="events"></a>

<h2>Method Details</h2>

<div class="detailHeader" id="authenticate-detail">
authenticate()
<span class="detailHeaderTag">
method
</span>
</div>

<table class="summaryTable">
<tr><td colspan="3">
<div class="signature2">
public boolean <b>authenticate</b>()</div>
</td></tr>
<tr>
  <td class="paramNameCol">{return}</td>
  <td class="paramTypeCol">boolean</td>
  <td class="paramDescCol">whether authentication succeeds.</td>
</tr>
</table>

<div class="sourceCode">
<b>Source Code:</b> app/components/UserIdentity.php#18 (<b><a href="#" class="show">show</a></b>)
<div class="code"><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">authenticate</span><span style="color: #007700">()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;check&nbsp;if&nbsp;login&nbsp;details&nbsp;exists&nbsp;in&nbsp;database<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$record</span><span style="color: #007700">=</span><span style="color: #0000BB">Usuarios</span><span style="color: #007700">::</span><span style="color: #0000BB">model</span><span style="color: #007700">()-&gt;</span><span style="color: #0000BB">findByAttributes</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'usuario'</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">username</span><span style="color: #007700">));&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//echo&nbsp;Yii::trace(CVarDumper::dumpAsString($record),'vardump');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if(</span><span style="color: #0000BB">$record</span><span style="color: #007700">===</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errorCode</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">ERROR_USERNAME_INVALID</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />else&nbsp;if(</span><span style="color: #0000BB">$record</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">passwd</span><span style="color: #007700">!==</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">password</span><span style="color: #007700">))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;here&nbsp;I&nbsp;compare&nbsp;db&nbsp;password&nbsp;with&nbsp;password&nbsp;field<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*echo&nbsp;Yii::trace(CVarDumper::dumpAsString($this-&gt;password),'vardump');<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;Yii::trace(CVarDumper::dumpAsString($record-&gt;passwd),'vardump');*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errorCode</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">ERROR_PASSWORD_INVALID</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setState</span><span style="color: #007700">(</span><span style="color: #DD0000">'userId'</span><span style="color: #007700">,</span><span style="color: #0000BB">$record</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">folio</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setState</span><span style="color: #007700">(</span><span style="color: #DD0000">'name'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$record</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">nombre</span><span style="color: #007700">.</span><span style="color: #DD0000">'&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$record</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">aPaterno</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errorCode</span><span style="color: #007700">=</span><span style="color: #0000BB">self</span><span style="color: #007700">::</span><span style="color: #0000BB">ERROR_NONE</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">errorCode</span><span style="color: #007700">;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*$users=array(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;username&nbsp;=&gt;&nbsp;password<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'demo'=&gt;'demo',<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'admin'=&gt;'admin',<br />&nbsp;&nbsp;&nbsp;&nbsp;);<br />&nbsp;&nbsp;&nbsp;&nbsp;if(!isset($users[$this-&gt;username]))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;errorCode=self::ERROR_USERNAME_INVALID;<br />&nbsp;&nbsp;&nbsp;&nbsp;elseif($users[$this-&gt;username]!==$this-&gt;password)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;errorCode=self::ERROR_PASSWORD_INVALID;<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;errorCode=self::ERROR_NONE;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!$this-&gt;errorCode;*/<br /></span><span style="color: #007700">}</span>
</span>
</code></div>
</div>
<p>Authenticates a user.
The example implementation makes sure if the username and password
are both 'demo'.
In practical applications, this should be changed to authenticate
against some persistent user identity storage (e.g. database).</p>


</div><!-- end of content -->

<div id="apiFooter">
Copyright &copy; 2008-2011 by <a href="http://www.yiisoft.com">Yii Software LLC</a><br/>
All Rights Reserved.<br/>
</div><!-- end of footer -->

<script type="text/javascript">
/*<![CDATA[*/
$("a.toggle").toggle(function(){
	$(this).text($(this).text().replace(/Hide/,'Show'));
	$(this).parents(".summary").find(".inherited").hide();
},function(){
	$(this).text($(this).text().replace(/Show/,'Hide'));
	$(this).parents(".summary").find(".inherited").show();
});
$(".sourceCode a.show").toggle(function(){
	$(this).text($(this).text().replace(/show/,'hide'));
	$(this).parents(".sourceCode").find("div.code").show();
},function(){
	$(this).text($(this).text().replace(/hide/,'show'));
	$(this).parents(".sourceCode").find("div.code").hide();
});
$("a.sourceLink").click(function(){
	$(this).attr('target','_blank');
});
/*]]>*/
</script>

</div><!-- end of page -->
</body>
</html>